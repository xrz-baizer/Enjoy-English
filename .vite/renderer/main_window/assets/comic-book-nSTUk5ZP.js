const h=({entries:i,loadBlob:a,getSize:l},d)=>{const r=new Map,s=new Map,f=async e=>{if(r.has(e))return r.get(e);const o=URL.createObjectURL(await a(e)),n=URL.createObjectURL(new Blob([`<!DOCTYPE html><html><head><meta charset="utf-8"></head><body style="margin: 0"><img src="${o}"></body></html>`],{type:"text/html"}));return s.set(e,[o,n]),r.set(e,n),n},p=e=>{s.get(e)?.forEach?.(o=>URL.revokeObjectURL(o)),s.delete(e),r.delete(e)},g=[".jpg",".jpeg",".png",".gif",".bmp",".webp",".svg",".jxl",".avif"],c=i.map(e=>e.filename).filter(e=>g.some(o=>e.endsWith(o))).sort();if(!c.length)throw new Error("No supported image files in archive");const t={};return t.getCover=()=>a(c[0]),t.metadata={title:d.name},t.sections=c.map(e=>({id:e,load:()=>f(e),unload:()=>p(e),size:l(e)})),t.toc=c.map(e=>({label:e,href:e})),t.rendition={layout:"pre-paginated"},t.resolveHref=e=>({index:t.sections.findIndex(o=>o.id===e)}),t.splitTOCHref=e=>[e,null],t.getTOCFragment=e=>e.documentElement,t.destroy=()=>{for(const e of s.values())for(const o of e)URL.revokeObjectURL(o)},t};export{h as makeComicBook};
//# sourceMappingURL=comic-book-nSTUk5ZP.js.map
