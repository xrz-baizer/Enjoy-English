const w=e=>e.replace(/\s+/g," "),I=(e,{startIndex:g,startOffset:a,endIndex:l,endOffset:c})=>{const r=e[g],o=e[l],h=r===o?r.slice(a,c):r.slice(a)+e.slice(r+1,o).join("")+o.slice(0,c),u=w(r.slice(0,a)).trimStart(),n=w(o.slice(c)).trimEnd(),t=u.length<50?"":"…",i=n.length<50?"":"…",s=`${t}${u.slice(-50)}`,m=`${n.slice(0,50)}${i}`;return{pre:s,match:h,post:m}},T=function*(e,g,a={}){const{locales:l="en",sensitivity:c}=a,r=c==="variant",o=e.join(""),h=r?o:o.toLocaleLowerCase(l),u=r?g:g.toLocaleLowerCase(l),n=u.length;let t=-1,i=-1,s=0;do if(t=h.indexOf(u,t+1),t>-1){for(;s<=t;)s+=e[++i].length;const m=i,d=t-(s-e[i].length),f=t+n;for(;s<=f;)s+=e[++i].length;const x=i,y=f-(s-e[i].length),p={startIndex:m,startOffset:d,endIndex:x,endOffset:y};yield{range:p,excerpt:I(e,p)}}while(t>-1)},E=function*(e,g,a={}){const{locales:l="en",granularity:c="word",sensitivity:r="base"}=a;let o,h;try{o=new Intl.Segmenter(l,{usage:"search",granularity:c}),h=new Intl.Collator(l,{sensitivity:r})}catch(s){console.warn(s),o=new Intl.Segmenter("en",{usage:"search",granularity:c}),h=new Intl.Collator("en",{sensitivity:r})}const u=Array.from(o.segment(g)).length,n=[];let t=0,i=o.segment(e[t])[Symbol.iterator]();e:for(;t<e.length;){for(;n.length<u;){const{done:m,value:d}=i.next();if(m)if(t++,t<e.length){i=o.segment(e[t])[Symbol.iterator]();continue}else break e;const{index:f,segment:x}=d;if(/[^\p{Format}]/u.test(x)){if(/\s/u.test(x)){/\s/u.test(n[n.length-1]?.segment)||n.push({strIndex:t,index:f,segment:" "});continue}d.strIndex=t,n.push(d)}}const s=n.map(m=>m.segment).join("");if(h.compare(g,s)===0){const m=t,d=n[n.length-1],f=d.index+d.segment.length,x=n[0].strIndex,y=n[0].index,p={startIndex:x,startOffset:y,endIndex:m,endOffset:f};yield{range:p,excerpt:I(e,p)}}n.shift()}},L=(e,g,a)=>{const{granularity:l="grapheme",sensitivity:c="base"}=a;return!Intl?.Segmenter||l==="grapheme"&&(c==="variant"||c==="accent")?T(e,g,a):E(e,g,a)},C=(e,g)=>{const{defaultLocale:a,matchCase:l,matchDiacritics:c,matchWholeWords:r,acceptNode:o}=g;return function*(h,u){const n=e(h,function*(t,i){for(const s of L(t,u,{locales:h.body.lang||h.documentElement.lang||a||"en",granularity:r?"word":"grapheme",sensitivity:c&&l?"variant":c&&!l?"accent":!c&&l?"case":"base"})){const{startIndex:m,startOffset:d,endIndex:f,endOffset:x}=s.range;s.range=i(m,d,f,x),yield s}},o);for(const t of n)yield t}};export{L as search,C as searchMatcher};
//# sourceMappingURL=search-UHG1SVDO.js.map
