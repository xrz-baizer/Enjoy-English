{"version":3,"file":"vidstack-FldwQc2Q-DEl0Q2me.js","sources":["../../../../node_modules/@vidstack/react/prod/chunks/vidstack-FldwQc2Q.js"],"sourcesContent":["\"use client\"\n\nimport { appendParamsToURL, IS_SERVER } from './vidstack-D5Pzx_k5.js';\nimport { signal, listenEvent, effect, peek, isString } from './vidstack-CZgUA94N.js';\n\nclass EmbedProvider {\n  #iframe;\n  src = signal(\"\");\n  /**\n   * Defines which referrer is sent when fetching the resource.\n   *\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/HTMLIFrameElement/referrerPolicy}\n   */\n  referrerPolicy = null;\n  get iframe() {\n    return this.#iframe;\n  }\n  constructor(iframe) {\n    this.#iframe = iframe;\n    iframe.setAttribute(\"frameBorder\", \"0\");\n    iframe.setAttribute(\"aria-hidden\", \"true\");\n    iframe.setAttribute(\n      \"allow\",\n      \"autoplay; fullscreen; encrypted-media; picture-in-picture; accelerometer; gyroscope\"\n    );\n    if (this.referrerPolicy !== null) {\n      iframe.setAttribute(\"referrerpolicy\", this.referrerPolicy);\n    }\n  }\n  setup() {\n    listenEvent(window, \"message\", this.#onWindowMessage.bind(this));\n    listenEvent(this.#iframe, \"load\", this.onLoad.bind(this));\n    effect(this.#watchSrc.bind(this));\n  }\n  #watchSrc() {\n    const src = this.src();\n    if (!src.length) {\n      this.#iframe.setAttribute(\"src\", \"\");\n      return;\n    }\n    const params = peek(() => this.buildParams());\n    this.#iframe.setAttribute(\"src\", appendParamsToURL(src, params));\n  }\n  postMessage(message, target) {\n    if (IS_SERVER) return;\n    this.#iframe.contentWindow?.postMessage(JSON.stringify(message), target ?? \"*\");\n  }\n  #onWindowMessage(event) {\n    const origin = this.getOrigin(), isOriginMatch = (event.source === null || event.source === this.#iframe?.contentWindow) && (!isString(origin) || origin === event.origin);\n    if (!isOriginMatch) return;\n    try {\n      const message = JSON.parse(event.data);\n      if (message) this.onMessage(message, event);\n      return;\n    } catch (e) {\n    }\n    if (event.data) this.onMessage(event.data, event);\n  }\n}\n\nexport { EmbedProvider };\n"],"names":["EmbedProvider","#iframe","signal","iframe","listenEvent","#onWindowMessage","effect","#watchSrc","src","params","peek","appendParamsToURL","message","target","IS_SERVER","event","origin","isString"],"mappings":"kFAKA,MAAMA,CAAc,CAClBC,GACA,IAAMC,EAAO,EAAE,EAMf,eAAiB,KACjB,IAAI,QAAS,CACX,OAAO,KAAKD,EACd,CACA,YAAYE,EAAQ,CAClB,KAAKF,GAAUE,EACfA,EAAO,aAAa,cAAe,GAAG,EACtCA,EAAO,aAAa,cAAe,MAAM,EACzCA,EAAO,aACL,QACA,qFACN,EACQ,KAAK,iBAAmB,MAC1BA,EAAO,aAAa,iBAAkB,KAAK,cAAc,CAE7D,CACA,OAAQ,CACNC,EAAY,OAAQ,UAAW,KAAKC,GAAiB,KAAK,IAAI,CAAC,EAC/DD,EAAY,KAAKH,GAAS,OAAQ,KAAK,OAAO,KAAK,IAAI,CAAC,EACxDK,EAAO,KAAKC,GAAU,KAAK,IAAI,CAAC,CAClC,CACAA,IAAY,CACV,MAAMC,EAAM,KAAK,IAAG,EACpB,GAAI,CAACA,EAAI,OAAQ,CACf,KAAKP,GAAQ,aAAa,MAAO,EAAE,EACnC,MACF,CACA,MAAMQ,EAASC,EAAK,IAAM,KAAK,YAAW,CAAE,EAC5C,KAAKT,GAAQ,aAAa,MAAOU,EAAkBH,EAAKC,CAAM,CAAC,CACjE,CACA,YAAYG,EAASC,EAAQ,CACvBC,GACJ,KAAKb,GAAQ,eAAe,YAAY,KAAK,UAAUW,CAAO,EAAGC,GAAU,GAAG,CAChF,CACAR,GAAiBU,EAAO,CACtB,MAAMC,EAAS,KAAK,UAAS,EAC7B,IADkDD,EAAM,SAAW,MAAQA,EAAM,SAAW,KAAKd,IAAS,iBAAmB,CAACgB,EAASD,CAAM,GAAKA,IAAWD,EAAM,QAEnK,IAAI,CACF,MAAMH,EAAU,KAAK,MAAMG,EAAM,IAAI,EACjCH,GAAS,KAAK,UAAUA,EAASG,CAAK,EAC1C,MACF,MAAY,CACZ,CACIA,EAAM,MAAM,KAAK,UAAUA,EAAM,KAAMA,CAAK,EAClD,CACF","x_google_ignoreList":[0]}